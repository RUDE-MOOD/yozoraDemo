# ノスタージア WEB3Dのデモです

# TODO LIST
```bash
＝＝＝やり直し＝＝＝
1.ドーム形を立方体にする ✅️
2.レイヤーを積み上げること ✅️

＝＝＝機能系＝＝＝
1.meshを作って一つの星を打ち上げる
2.dreiライブラリのTextを作って星の情報を画面上に表示する
3.UIを追加して、入力欄を追加
＝＝＝ビジュアル系＝＝＝
後回し
...
```
## Development Tools
このプロジェクトは **Antigravity + Skills** AI を使用して開発されました。
- **Antigravity**: 高度なエージェントAIによるコーディング支援
- **Skills**: R3F (React Three Fiber) に特化した専門知識モジュール（Geometry, Postprocessing, Shadersなど）を活用し、ベストプラクティスに沿った実装を行っています。



# 環境初期化
1.git cloneまたはソースコードをダウンロードする<br>
2.フォルダーパスのターミナルを開いてyarnでライブラリを初期化（学校のネットワークでうまくできない場合はテザリングなど別のネット環境でリトライ）<br>
3.初期化ができ次第、yarn devで実行する<br>


<h2>レイヤー構造</h2>
<h4>プラネタリウム自体が７つのレイヤーでできている。</h4>
<ol>
  <li>背景（宇宙の色）<br>Three.jsのシェーダー。自由に変えられるようにするため画像を使用しない。</li>
  <li>流体層（天の川風）<br>GPUへの負荷の最小限に抑えるため、ノイズシェーダーを使用。UVマップをゆっくりずらすことで動いているように見せる。</li>
  <li>背景の遠い星 <br>ユーザーが操作しないのでノイズマップですませる。</li>
  <li>霧 <br>さらに立体感を出すためのレイヤー。3Dボリュームでやるとすごく重たくなるのでこれもノイズマップで実現する。深度に応じて透明度の変化もできる。</li>
  <li>星（ユーザーが操作できる）<br>3Dで描画する。ユーザーの感情やその日の重要度に応じて輝度、大きさ、色が変化。レンダーしないグリッド上に存在する。ユーザーが押下するとその思い出のメニューが出てくる。</li>
  <li>ビネット <br>画面の角を暗くすることで立体感が出る。</li>
  <li>UI描画 （ユーザーが操作できる）<br>メニューやボタンのような要素を描画するレイヤー</li>
</ol>
<p>こういう風にレイヤー毎に分けると、各要素を独立させレイヤー同士の直接依存が生じず拡張性を高めることができる。レイヤー毎の描画トグル・テーマの切り替え・低スペック端末向けのパフォーマンス描画モードも実装可能。</p>

# コンポーネント
## Experience
各コンポーネントを組み立てるためのメインコンテナ。
CameraControlsを使用し、ズームや移動の制限（最小・最大距離、パン範囲）を設定済み。
スマホなどのタッチ操作（ピンチズーム）にも対応。


## Effects
`@react-three/postprocessing`を使用した映像効果を担当。
- **Bloom**: 星の輝きを強調し、光暈（ハロー）を追加。
- **Noise**: フィルムライクな粒子感を加え、デジタル的な冷たさを軽減。
- **Vignette**: 画面四隅を減光させ、視線を中央へ誘導しつつ没入感を高める。
- **ToneMapping**: HDRレンダリングの色調を補正（ACESFilmic）し、白飛びを抑えつつコントラストを確保。

## SkyBox
以前のSkydome（半球体）から変更し、複数の平面レイヤーを重ねた構造（Cuboid的アプローチ）。
以下の4層で深みのある夜空を表現：
1. **Background**: 宇宙のベースカラー
2. **Fluid**: 天の川のような流体ノイズ
3. **Stars**: 瞬く遠景の星々
4. **Fog**: 奥行きを出すための霧
各レイヤーは専用のシェーダーで描画され、軽量かつ表現豊かに実装。


